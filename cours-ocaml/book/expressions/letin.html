<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Définitions locales - Cours de OCaml</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../intro.html">Introduction</a></li><li class="chapter-item expanded "><a href="../expressions.html"><strong aria-hidden="true">1.</strong> Expressions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../expressions/environnements.html"><strong aria-hidden="true">1.1.</strong> Définitions globales</a></li><li class="chapter-item expanded "><a href="../expressions/letin.html" class="active"><strong aria-hidden="true">1.2.</strong> Définitions locales</a></li><li class="chapter-item expanded "><a href="../expressions/fonctions.html"><strong aria-hidden="true">1.3.</strong> Fonctions</a></li><li class="chapter-item expanded "><a href="../expressions/if.html"><strong aria-hidden="true">1.4.</strong> Expressions conditionnelles</a></li></ol></li><li class="chapter-item expanded "><a href="../types.html"><strong aria-hidden="true">2.</strong> Types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../types/scalaires.html"><strong aria-hidden="true">2.1.</strong> Types scalaires</a></li><li class="chapter-item expanded "><a href="../types/tuples.html"><strong aria-hidden="true">2.2.</strong> Les tuples</a></li><li class="chapter-item expanded "><a href="../types/record.html"><strong aria-hidden="true">2.3.</strong> Les types enregistrement</a></li><li class="chapter-item expanded "><a href="../types/enum.html"><strong aria-hidden="true">2.4.</strong> Les types somme</a></li><li class="chapter-item expanded "><a href="../types/param.html"><strong aria-hidden="true">2.5.</strong> Les types parametrés</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Cours de OCaml</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="définitions-locales"><a class="header" href="#définitions-locales">Définitions locales</a></h1>
<p>Lorsqu'on donne un nom à une valeur, celle-ci est en général utilisée dans une petite partie de code et non pas dans le programme en entier. De manière générale lorqu'on programme, on se concentre sur une très petite portion de code et on ignore quels noms de valeurs ont été ou seront utilisés ailleurs dans le programme.</p>
<p>L'utilisation de <strong>définitions locales</strong> permet d'éviter de surcharger l'environnement global. De plus, on évite aussi de masquer involontairement une valeur globale ou d'utiliser un nom qui pourrait être masqué par une autre définition globale. C'est donc une bonne pratique de programmation d'utiliser des <strong>définitions locales</strong> dès que cela s'avère possible.</p>
<p>Pour définir une valeur localement on utilise les mots clefs <strong>let</strong> et <strong>in</strong> ainsi :</p>
<pre><code class="language-ocaml">let x = 5 in 2 * x + 1;;
</code></pre>
<p>l'interprète répond alors :</p>
<pre><code>- : int = 11
</code></pre>
<p>A première vue, tout semble se passer comme pour une définition globale mais ce n'est pas le cas :</p>
<pre><code class="language-ocaml">let x = 4 in 2 * x + 1;;
x * x + 2;;
</code></pre>
<p>produira l'erreur <code>Unbound value x</code> à la deuxième ligne car <code>x</code> a été uniquement défini <strong>localement</strong> à l'expression <code>2 * x + 1</code>.</p>
<p>Il est également possible de définir plusieurs valeurs locales en enchaînant les <strong>let .. in</strong> :</p>
<pre><code class="language-ocaml">let longueur = 3 in
let largeur = 5 in
longueur * largeur;;
</code></pre>
<h2 id="pile-denvironnement--empilements-et-dépilements"><a class="header" href="#pile-denvironnement--empilements-et-dépilements">Pile d'environnement : empilements et dépilements</a></h2>
<p>Pour bien comprendre le <code>let ... in</code> revenons à la représentation sous forme de pile de l'environnement. Lorsqu'on utilise <code>let x = expr1 in expr2</code> la valeur de <code>expr1</code> sera temporairement liée au nom <code>x</code> lors de l'évaluation de <code>expr2</code>. Concrètement, cela signifie qu'on <strong>empilera</strong> la valeur <code>x</code> dans l'environnement avant d'évaluer <code>expr2</code>, puis immédiatement, cette valeur sera <strong>dépilée</strong> de l'environnement.</p>
<p>Etudions cela sur un exemple :</p>
<pre><code class="language-ocaml">let a = 5;;
let b = 3 + 4;;
let a = 17 in a + b;;
a * b;;
</code></pre>
<p>Après l'évaluation des deux premières expressions, la pile d'environnement vaut :</p>
<div class="table-wrapper"><table><thead><tr><th>Environnement</th></tr></thead><tbody>
<tr><td>b = 7</td></tr>
<tr><td>a = 5</td></tr>
</tbody></table>
</div>
<p>Ensuite, l'évaluation de la troisième expression se fait dans un environnement où <code>a = 17</code> a été temporairement empilée :</p>
<div class="table-wrapper"><table><thead><tr><th>Environnement</th></tr></thead><tbody>
<tr><td>a = 17</td></tr>
<tr><td>b = 7</td></tr>
<tr><td>a = 5</td></tr>
</tbody></table>
</div>
<p>C'est pourquoi le résultat de l'évaluation de la 3e expression donnera 24. La valeur précédente de <code>a</code> est temporairement <strong>masquée</strong>.</p>
<p>Puis, l'association <code>a = 17</code> est dépilée pour l'évaluation de la dernière expression et <code>a</code> <em>retrouve</em> sa valeur prédente. Le résultat sera donc 35.</p>
<h2 id="let--in-est-une-expression"><a class="header" href="#let--in-est-une-expression">let ... in est une expression</a></h2>
<p>Il existe une dernière différence importante entre le <code>let</code> et le <code>let .. in</code> : le <code>let .. in</code> est une <strong>expression</strong>, ce qui signifie :</p>
<ul>
<li>qu'elle possède un type</li>
<li>qu'elle possède une valeur</li>
<li>qu'elle peut être utilisée au sein d'une autre expression</li>
</ul>
<p>Par exemple, imagions qu'un gateau coûte habituellement 18 euros, et qu'une promotion exceptionnelle réduise le prix de 5 euros, alors on peut calculer le prix de l'achat de 15 gateâux par :</p>
<pre><code class="language-ocaml">15 * (let prix_base = 18 in prix_base - 5)
</code></pre>
<p>L'expression entre parenthèses est une expression <code>let ... in</code> de type entier et de valeur 13. </p>
<p>C'est aussi pour cette raison qu'il est possible d'utiliser consécutivement plusieurs <code>let ... in</code> :</p>
<pre><code class="language-ocaml">let longueur = 3 in
let largeur = 5 in
longueur * largeur;;
</code></pre>
<p>Ici, <code>longueur</code> est en fait définie localement dans l'expression <code>let largeur in longueur * largeur</code>.</p>
<h2 id="let-ou-let--in-"><a class="header" href="#let-ou-let--in-"><code>let</code> ou <code>let ... in</code> ?</a></h2>
<p>Comment choisir s'il faut définir une valeur localement ou globalement ?
La réponse est simple : si la valeur définie est destinée à être utilisée dans l'ensemble du programme, par exemple s'il s'agit d'une définition de fonction, alors la définition devra être globale.</p>
<p>Dans tous les autres cas, on préférera une définition locale. En particulier, les définitions de valeurs internes à une fonction seront toujours locales.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../expressions/environnements.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../expressions/fonctions.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../expressions/environnements.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../expressions/fonctions.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
