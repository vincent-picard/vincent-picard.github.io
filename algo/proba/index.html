
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Page personnelle de Vincent Picard et ressources pour l'informatique en MPI">
      
      
        <meta name="author" content="Vincent Picard">
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Algorithmes probabilistes, algorithmes d'approximation - Vincent Picard - Informatique CPGE</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/definition.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#algorithmes-probabilistes-algorithmes-dapproximation" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../.." title="Vincent Picard - Informatique CPGE" class="md-header__button md-logo" aria-label="Vincent Picard - Informatique CPGE" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M0 96c0-35.3 28.7-64 64-64h320c35.3 0 64 28.7 64 64v320c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64zm144 4c-24.3 0-44 19.7-44 44v48c0 24.3 19.7 44 44 44h32c24.3 0 44-19.7 44-44v-48c0-24.3-19.7-44-44-44zm-4 44c0-2.2 1.8-4 4-4h32c2.2 0 4 1.8 4 4v48c0 2.2-1.8 4-4 4h-32c-2.2 0-4-1.8-4-4zm140-44c-11 0-20 9-20 20 0 9.7 6.9 17.7 16 19.6V216c0 11 9 20 20 20s20-9 20-20v-96c0-11-9-20-20-20zM132 296c0 9.7 6.9 17.7 16 19.6V392c0 11 9 20 20 20s20-9 20-20v-96c0-11-9-20-20-20h-16c-11 0-20 9-20 20m96 24v48c0 24.3 19.7 44 44 44h32c24.3 0 44-19.7 44-44v-48c0-24.3-19.7-44-44-44h-32c-24.3 0-44 19.7-44 44m44-4h32c2.2 0 4 1.8 4 4v48c0 2.2-1.8 4-4 4h-32c-2.2 0-4-1.8-4-4v-48c0-2.2 1.8-4 4-4"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vincent Picard - Informatique CPGE
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Algorithmes probabilistes, algorithmes d'approximation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Onglets" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../aboutme/" class="md-tabs__link">
          
  
  
  À propos de moi

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mpi/cours/" class="md-tabs__link">
          
  
  
  Informatique MPI

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../itc/" class="md-tabs__link">
        
  
  
    
  
  Informatique tronc commun

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../links/" class="md-tabs__link">
        
  
  
    
  
  Liens utiles

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../config/" class="md-tabs__link">
        
  
  
    
  
  Configuration machine

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../i8080/" class="md-tabs__link">
          
  
  
  Émulateur i8080

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Vincent Picard - Informatique CPGE" class="md-nav__button md-logo" aria-label="Vincent Picard - Informatique CPGE" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M0 96c0-35.3 28.7-64 64-64h320c35.3 0 64 28.7 64 64v320c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64zm144 4c-24.3 0-44 19.7-44 44v48c0 24.3 19.7 44 44 44h32c24.3 0 44-19.7 44-44v-48c0-24.3-19.7-44-44-44zm-4 44c0-2.2 1.8-4 4-4h32c2.2 0 4 1.8 4 4v48c0 2.2-1.8 4-4 4h-32c-2.2 0-4-1.8-4-4zm140-44c-11 0-20 9-20 20 0 9.7 6.9 17.7 16 19.6V216c0 11 9 20 20 20s20-9 20-20v-96c0-11-9-20-20-20zM132 296c0 9.7 6.9 17.7 16 19.6V392c0 11 9 20 20 20s20-9 20-20v-96c0-11-9-20-20-20h-16c-11 0-20 9-20 20m96 24v48c0 24.3 19.7 44 44 44h32c24.3 0 44-19.7 44-44v-48c0-24.3-19.7-44-44-44h-32c-24.3 0-44 19.7-44 44m44-4h32c2.2 0 4 1.8 4 4v48c0 2.2-1.8 4-4 4h-32c-2.2 0-4-1.8-4-4v-48c0-2.2 1.8-4 4-4"/></svg>

    </a>
    Vincent Picard - Informatique CPGE
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    À propos de moi
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    À propos de moi
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aboutme/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 11.75A1.25 1.25 0 0 0 7.75 13 1.25 1.25 0 0 0 9 14.25 1.25 1.25 0 0 0 10.25 13 1.25 1.25 0 0 0 9 11.75m6 0A1.25 1.25 0 0 0 13.75 13 1.25 1.25 0 0 0 15 14.25 1.25 1.25 0 0 0 16.25 13 1.25 1.25 0 0 0 15 11.75M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2m0 18c-4.41 0-8-3.59-8-8 0-.29 0-.58.05-.86 2.36-1.05 4.23-2.98 5.21-5.37a9.97 9.97 0 0 0 10.41 3.97c.21.71.33 1.47.33 2.26 0 4.41-3.59 8-8 8"/></svg>
  
  <span class="md-ellipsis">
    
  
    À propos de moi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aboutme/enseignement/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 17a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H9.46c.35.61.54 1.3.54 2h10v11h-9v2m4-10v2H9v13H7v-6H5v6H3v-8H1.5V9a2 2 0 0 1 2-2zM8 4a2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2 2 2 0 0 1 2 2"/></svg>
  
  <span class="md-ellipsis">
    
  
    Enseignement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aboutme/parcours/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Parcours
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Informatique MPI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Informatique MPI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mpi/cours/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cours
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mpi/tp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Travaux pratiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mpi/td/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Travaux dirigés
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mpi/colles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Programmes de colles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../itc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Informatique tronc commun
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../links/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Liens utiles
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration machine
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Émulateur i8080
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Émulateur i8080
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture générale
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/flags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les flags
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/makefile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Makefile et tests unitaires
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/carry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les instructions du carry bit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/rotate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les instructions de décalage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/datatransfer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les instructions de transfert
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/direct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les instructions à adressage direct
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/alu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    L'unité arithmétique et logique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/immediate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les instructions immédiates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../i8080/regtoacc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les instructions regisre vers accumulateur
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-algorithmes-probabilistes" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Algorithmes probabilistes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Algorithmes probabilistes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-generation-du-hasard" class="md-nav__link">
    <span class="md-ellipsis">
      
        A. Génération du hasard
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A. Génération du hasard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#en-langage-c" class="md-nav__link">
    <span class="md-ellipsis">
      
        En langage C
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#en-langage-ocaml" class="md-nav__link">
    <span class="md-ellipsis">
      
        En langage OCaml
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#une-astuce-a-connaitre" class="md-nav__link">
    <span class="md-ellipsis">
      
        Une astuce à connaître
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-algorithmes-de-las-vegas" class="md-nav__link">
    <span class="md-ellipsis">
      
        B. Algorithmes de Las Vegas
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="B. Algorithmes de Las Vegas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tri-rapide-probabiliste" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tri rapide probabiliste
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selection-rapide-quick-select" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sélection rapide (quick select)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-algorithmes-de-monte-carlo" class="md-nav__link">
    <span class="md-ellipsis">
      
        C. Algorithmes de Monte Carlo
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C. Algorithmes de Monte Carlo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tester-si-un-nombre-est-premier" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tester si un nombre est premier
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#las-vegas-monte-carlo-generer-un-nombre-probablement-premier-de-taille-cryptographique" class="md-nav__link">
    <span class="md-ellipsis">
      
        Las Vegas + Monte Carlo : générer un nombre probablement premier de taille cryptographique
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algorithme-du-recuit-simule" class="md-nav__link">
    <span class="md-ellipsis">
      
        Algorithme du recuit simulé
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-algorithmes-dapproximation" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Algorithmes d'approximation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Algorithmes d&#39;approximation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-problemes-de-decision-et-doptimisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        A. Problèmes de décision et d'optimisation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A. Problèmes de décision et d&#39;optimisation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lien-avec-les-problemes-de-decision" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lien avec les problèmes de décision
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-algorithme-dapproximation" class="md-nav__link">
    <span class="md-ellipsis">
      
        B. Algorithme d'approximation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="B. Algorithme d&#39;approximation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#le-probleme-max-sat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Le problème MAX-SAT
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="algorithmes-probabilistes-algorithmes-dapproximation">Algorithmes probabilistes, algorithmes d'approximation</h1>
<h2 id="1-algorithmes-probabilistes">1. Algorithmes probabilistes</h2>
<p>Un algorithme est dit <strong>probaliste</strong> lorsque son exécution dépend de valeurs générées aléatoirement. Nous étudierons à l'aide d'exemples, deux classes d'algorithmes probabilistes :</p>
<ul>
<li>Les algorithmes de <strong>Las Vegas</strong> qui donnent toujours un résultat correct mais dont le temps d'exécution est aléatoire. L'idée est que l'espérance du temps d'exécution soit meilleure que celle d'un algorithme déterministe.</li>
<li>Les algorithmes de <strong>Monte Carlo</strong> qui donnent un résultat qui n'est pas forcément correct (soit faux avec faible probabilité, soit approché) mais dont le temps d'exécution est déterministe.</li>
</ul>
<h3 id="a-generation-du-hasard">A. Génération du hasard</h3>
<p>En informatique,  le hasard est généré à l'aide de nombre pseudo-aléatoires. Ces nombres sont obtenus comme les valeurs d'une certaine suite récurrente de type <span class="arithmatex">\(u_{n+1} = f(u_n)\)</span>. La valeur <span class="arithmatex">\(u_0\)</span> utilisée est appelée la graine (<em>seed</em> en anglais).
La graine peut-être choisie au choix :</p>
<ul>
<li>arbitrairement (rend le programme déterministe, utile pour débugger)</li>
<li>comme le numéro <code>PID</code> d'identification du processus actuel</li>
<li>avec l'heure actuelle du systeme</li>
<li>en utilisant un <em>vrai</em> hasard construit matériellement en mesurant le bruit thermique (instruction <code>RDRAND</code> disponible depuis 2012 sur les processeurs Intel)</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Attention</p>
<p>Attention l'initialisation de la graine ne doit avoir lieu qu'une seule fois au début de votre programme.</p>
</div>
<h4 id="en-langage-c">En langage C</h4>
<p>En langage C, les fonctions de hasard sont définies dans <code>stdlib.h</code>, la graine peut-être initialisée ainsi :
<div class="language-c highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;time.h&gt;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>On peut ensuite utiliser la fonction <code>rand</code> qui génère une valeur entière quelconque uniformément entre 0 et la constante <code>RAND_MAX</code> incluse, supposée grande.
Il n'y a pas de fonction pour générer un flottant aléatoire, il faut ruser un peu :
<div class="language-c highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="p">...</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">();</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="c1">// Un entier entre 0 et N-1</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="n">Q</span><span class="o">-</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// Un entier entre P et Q </span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="n">RAND_MAX</span><span class="p">;</span><span class="w"> </span><span class="c1">// Un flottant entre 0 et 1</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="n">RAND_MAX</span><span class="p">;</span><span class="w"> </span><span class="c1">// Un flottant entre 0 et 5</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="p">}</span>
</span></code></pre></div></p>
<h4 id="en-langage-ocaml">En langage OCaml</h4>
<p>En langage OCaml, les fonctions de hasard sont définies dans le module <code>Random</code>, la graine peut être initialisée ainsi :
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nn">Random</span><span class="p">.</span><span class="n">self_init</span> <span class="bp">()</span><span class="o">;;</span>
</span></code></pre></div>
Caml choisit automatiquement la meilleure source de hasard disponible sur votre système pour le choix de la graine.</p>
<p>Le module propose ensuite des fonctions pour générer des valeurs aléatoires. Voir le <a href="https://v2.ocaml.org/api/Random.html">manuel OCaml</a> pour une présentation exhaustive.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c">(* Un entier entre p inclus et q exclus *)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">let</span> <span class="n">a</span> <span class="o">=</span> <span class="nn">Random</span><span class="p">.</span><span class="n">int</span> <span class="n">p</span> <span class="n">q</span><span class="o">;;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c">(* Un flottant entre 0 et 5 inclus *)</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="k">let</span> <span class="n">u</span> <span class="o">=</span> <span class="nn">Random</span><span class="p">.</span><span class="n">float</span> <span class="mi">5</span><span class="o">.</span><span class="mi">0</span><span class="o">;;</span>
</span></code></pre></div>
<h4 id="une-astuce-a-connaitre">Une astuce à connaître</h4>
<p>Lorsqu'on écrit un programme probabiliste il est souvent utile d'obtenir un branchement probabiliste de type :</p>
<ul>
<li>avec une probablité <span class="arithmatex">\(p\)</span> faire A</li>
<li>sinon (avec une probabilité <span class="arithmatex">\(1 - p\)</span>) faire B</li>
</ul>
<p>Pour cela on peut utiliser pour test, l'expression booléeenne <span class="arithmatex">\(X &lt; p\)</span> où <span class="arithmatex">\(X\)</span> est une valeur aléatoire flottante générée dans <span class="arithmatex">\([0, 1]\)</span>. Cela fonctionne car dans ce cas <span class="arithmatex">\(P(X &lt; p) = p\)</span>.</p>
<p>Considérons l'exemple suivant qui consiste à tirer à pile ou face <span class="arithmatex">\(n\)</span> fois avec une pièce truquée (<span class="arithmatex">\(p\)</span> est la probabilité de faire face) et dans lequel on compte le nombre de face obtenus :</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">let</span> <span class="n">nb_succes</span> <span class="n">n</span> <span class="n">p</span> <span class="o">=</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="k">let</span> <span class="n">compteur</span> <span class="o">=</span> <span class="n">ref</span> <span class="mi">0</span> <span class="k">in</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="k">for</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">to</span> <span class="n">n</span> <span class="k">do</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>        <span class="k">if</span> <span class="o">(</span><span class="nn">Random</span><span class="p">.</span><span class="n">float</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">p</span><span class="o">)</span> <span class="k">then</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>            <span class="n">incr</span> <span class="n">compteur</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="k">done</span><span class="o">;</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="o">!</span><span class="n">compteur</span><span class="o">;;</span>
</span></code></pre></div>
<h3 id="b-algorithmes-de-las-vegas">B. Algorithmes de <em>Las Vegas</em></h3>
<p>Un algorithme de <em>Las Vegas</em> est un algorithme probabiliste qui donne toujours un résultat exact. L'utilisation du hasard permet en général d'obtenir de meilleurs performances d'exécution.</p>
<h4 id="tri-rapide-probabiliste">Tri rapide probabiliste</h4>
<p>On sait que dans le pire cas, c'est-à-dire par exemple quand l'entrée est déjà triée, le tri rapide utilise <span class="arithmatex">\(O(n^2)\)</span> compraisons.</p>
<p>On peut améliorer ce résultat en choisissant le pivot de manière aléatoire entre les indices <span class="arithmatex">\(0\)</span> et <span class="arithmatex">\(n-1\)</span>. Cela permet d'obtenir un nombre de comparaisons de <span class="arithmatex">\(O(n \log n)\)</span> en moyenne.</p>
<p>Le résultat sera toujours un tableau trié mais les performances d'exécution ont été améliorées.</p>
<h4 id="selection-rapide-quick-select">Sélection rapide (quick select)</h4>
<p>Considérons un tableau de taille <span class="arithmatex">\(n\)</span> dans lequel on souhaite déterminer la <span class="arithmatex">\(t\)</span>-ième plus grande valeur. Une manière de faire est de trier le tableau. Cependant, on sait qu'un tri par comparaisons effectuera au minimum <span class="arithmatex">\(\Omega(n \log n)\)</span> comparaisons dans le pire cas.</p>
<p>Hoare propose en 1961 l'algorithme probabiliste de type <em>Las Vegas</em> suivant :</p>
<ol>
<li>Choisir une valeur <span class="arithmatex">\(y\)</span> au hasard dans le tableau</li>
<li>Comparer <span class="arithmatex">\(y\)</span> avec les <span class="arithmatex">\(n-1\)</span> autres valeurs en réorganisant le tableau pour avoir les valeurs plus petites de <span class="arithmatex">\(y\)</span> à gauche et les plus grandes à droite : à l'instar du tri rapide. <span class="arithmatex">\(y\)</span> finit en position d'indice <span class="arithmatex">\(k\)</span>.</li>
<li>Si <span class="arithmatex">\(k = t - 1\)</span> retourner <span class="arithmatex">\(y\)</span></li>
<li>Si <span class="arithmatex">\(k &gt; t - 1\)</span> chercher le <span class="arithmatex">\(t\)</span>-ième élément du sous-tableau <span class="arithmatex">\(T[0] \dots T[k-1]\)</span> avec la même méthode</li>
<li>Si <span class="arithmatex">\(k &lt; t - 1\)</span> chercher le <span class="arithmatex">\((t-k-1)\)</span>-ième élément du sous-tableau <span class="arithmatex">\(T[k+1] \dots T[n-1]\)</span> avec la même méthode.</li>
</ol>
<p>L'analyse mathématique du nombre moyen de comparaisons est un peu technique : elle a été publiée 10 ans plus tard (toujours par Hoare). On peut par exemple montrer que le nombre moyen de comparaisons à effectuer  avec cet algorithme pour trouver la valeur médiane d'un ensemble de <span class="arithmatex">\(n\)</span> valeurs est de l'ordre de :</p>
<div class="arithmatex">\[
(2 + 2 \ln 2) n
\]</div>
<p>C'est donc un temps linéaire ce qui est beaucoup plus efficace que de trier le tableau.</p>
<p>Voici une implémentation en langage C de cette fonction :
<div class="language-c highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;time.h&gt;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="kt">void</span><span class="w"> </span><span class="nf">echanger</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="p">[],</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">a</span><span class="p">];</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="n">t</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">b</span><span class="p">];</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="n">t</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="p">;</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="p">}</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="c1">//Pivote le sous-tableau t[a:b] avec p le choix d&#39;indice de pivot</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="c1">//Retourne la position finale du pivot</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="c1">//</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="kt">int</span><span class="w"> </span><span class="nf">pivoter</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="p">[],</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">    </span><span class="n">echanger</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// On place le pivot au début</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="c1">// position actuelle du pivot</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">q</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">            </span><span class="n">echanger</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">            </span><span class="n">echanger</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">            </span><span class="n">q</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="p">}</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="c1">// Retourne la k-ième plus grande valeur du sous-tableau t[a:b]</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="c1">// Attention : modifie le tableau</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="kt">int</span><span class="w"> </span><span class="nf">quickselect</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="p">[],</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="w">   </span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="w">   </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Pivot choisi en pos %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="w">   </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pivoter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">p</span><span class="p">];</span>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">quickselect</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a><span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">quickselect</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="w">   </span><span class="p">}</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="p">}</span>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a><span class="w">    </span><span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">};</span>
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Valeur mediane %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">quickselect</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">));</span>
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a><span class="p">}</span>
</span></code></pre></div></p>
<h3 id="c-algorithmes-de-monte-carlo">C. Algorithmes de <em>Monte Carlo</em></h3>
<p>Un algorithme de <em>Monte Carlo</em> est un algorithme probabiliste qui s'exécute en un temps déterministe (qui ne dépend pas du hasard). Le résultat est soumis à une incertitude :
* soit il est parfois faux (on espère avec une faible probabilité)
* soit il est approximatif</p>
<h4 id="tester-si-un-nombre-est-premier">Tester si un nombre est premier</h4>
<p>L'algorithme naïf pour tester si <span class="arithmatex">\(p\)</span> est premier a une complexité <span class="arithmatex">\(O(p)\)</span>. Cela est suffisant pour tester si un petit entier est premier, mais cela n'est pas adapté aux applications cryptographiques. Typiquement la taille des entiers utilisés en cryptographie est de l'ordre de 512 bits, ce qui représente 155 chiffres en base 10. Même si une itération de boucle pouvait s'effectuer en 1 nanoseconde, il faudrait de l'ordre de <span class="arithmatex">\(10^{137}\)</span> années pour vérifier si un entier de taille cryptographique est premier.</p>
<p>Pour résoudre ce problème on utilise des tests de primalité qui sont des algorithmes probabilistes. A titre d'exemple, on peut considérer le test de Fermat qui repose sur le petit théorème de Fermat :</p>
<div class="admonition tip">
<p class="admonition-title">Petit théorème de Fermat</p>
<p>Soit <span class="arithmatex">\(p\)</span> un nombre premier et <span class="arithmatex">\(a\)</span> un entier non divisible par <span class="arithmatex">\(p\)</span> alors <span class="arithmatex">\(a^{p-1} \equiv 1 \, (\mathrm{mod}\  p)\)</span>.</p>
</div>
<p>L'algorithme probabiliste qui en découle est le suivant :</p>
<ol>
<li>Choisir une entier <span class="arithmatex">\(a\)</span> qui vérifie <span class="arithmatex">\(1 &lt; a &lt; p\)</span>.</li>
<li>Tester si <span class="arithmatex">\(a^{p-1} \equiv 1 \, (\mathrm{mod}\ p)\)</span></li>
<li>Si le test est vrai : répondre vrai</li>
<li>Si le test est faux : répondre faux</li>
</ol>
<p>C'est bien un algorithme de <em>Monte Carlo</em> : le temps d'exécution ne dépend pas du hasard. De plus, si l'algorithme répond faux l'algorithme est correct. Si l'algorithme répond vrai il est possible qu'il se trompe (mais avec une faible probabilité). Rappelons en effet que le calcul de <span class="arithmatex">\(a^{p-1} \, (\mathrm{mod}\ p)\)</span> peut renvoyer <span class="arithmatex">\(p\)</span> valeurs possibles et que seule la valeur 1 est acceptée.
Un entier <span class="arithmatex">\(p\)</span> qui reussit ce test est dit <em>probablement premier</em></p>
<p>Si on veut diminuer le risque d'erreur, on peut répéter ce test <span class="arithmatex">\(k\)</span> fois :</p>
<ol>
<li>Choisir <span class="arithmatex">\(k\)</span> entiers aléatoires <span class="arithmatex">\(a\)</span> dans <span class="arithmatex">\(]1, p[\)</span></li>
<li>Tester si chaque <span class="arithmatex">\(a\)</span> vérifie <span class="arithmatex">\(a^{p-1} \equiv 1 \, (\mathrm{mod}\ p)\)</span></li>
<li>Dès qu'un test échoue : répondre faux</li>
<li>Si tous les tests réussissent : répndre vrai</li>
</ol>
<p>Proposons une implémentation en langage <code>Python</code> de cette procédure. Nous utilisons exceptionnellement <code>Python</code> car il permet de pouvoir manipuler les grands entiers (&gt; 64 bits) de manière native. On commence par implémenter le calcul de <span class="arithmatex">\(a^n \, (\mathrm{mod}\ p)\)</span> appelé <em>exponentiation modulaire</em> en utilisant l'algorithme d'<em>exponentiation rapide</em>. On implémente ensuite la procédure avec <span class="arithmatex">\(k\)</span> répétitions du test.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># Calcul a^n modulo p</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">mod_exp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>        <span class="k">return</span> <span class="mi">1</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>        <span class="k">return</span> <span class="n">mod_exp</span><span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">mod_exp</span><span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="o">%</span> <span class="n">p</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_de_fermat</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="c1"># On itère k fois le test de fermat</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>        <span class="k">if</span> <span class="n">mod_exp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>    <span class="k">return</span> <span class="kc">True</span>
</span></code></pre></div>
<p>Aparté mathématique : si le nombre <span class="arithmatex">\(p\)</span> n'est pas premier et n'est pas un nombre de Carmichael (nombres très rares), alors il y a une probabilité <span class="arithmatex">\(\leq 1/2\)</span> que le test réussisse. Autrement dit si on répète le test <span class="arithmatex">\(k\)</span> fois comme on l'a fait, il y a une probabilité d'erreur inférieure à <span class="arithmatex">\(1/2^k\)</span>.</p>
<p>Il existe des tests encore plus précis que celui de Fermat : Miller-Rabin, Solovay-Strassen.</p>
<h4 id="las-vegas-monte-carlo-generer-un-nombre-probablement-premier-de-taille-cryptographique">Las Vegas + Monte Carlo : générer un nombre probablement premier de taille cryptographique</h4>
<p>Pour générer un nombre premier de taille cryptographique, disons de 512 bits, on peut utiliser l'algorithme de type <em>Las Vegas</em> suivant :</p>
<ol>
<li>Générer un nombre aléatoire <span class="arithmatex">\(n\)</span> impair de taille 512 bits</li>
<li>Tester avec un algorithme de Monte Carlo si <span class="arithmatex">\(n\)</span> est probablement premier</li>
<li>Si oui, retourner <span class="arithmatex">\(n\)</span></li>
<li>Si non, faire <span class="arithmatex">\(n \gets n + 2\)</span> et aller en 2</li>
</ol>
<p>Ce type de procédure est aujourd'hui utilisé par les librairies cryptographiques telles que SSL (https).</p>
<p>Voici une implémentation en <code>Python</code> de cet algorithme qui permet de générer en moins d'une seconde un grand nombre premier :</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Génère un nombre entier impair de 512 bits</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">random_big_odd_int</span><span class="p">():</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">511</span><span class="p">):</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>        <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="n">rd</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>    <span class="k">return</span> <span class="n">n</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="c1"># Génère un nombre premier de taille cryptographique</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">big_prime</span><span class="p">():</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">random_big_odd_int</span><span class="p">()</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>    <span class="n">echecs</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>    <span class="k">while</span> <span class="ow">not</span><span class="p">(</span><span class="n">test_de_fermat</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">10</span><span class="p">)):</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>           <span class="n">echecs</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>           <span class="n">n</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Echecs : &quot;</span><span class="p">,</span> <span class="n">echecs</span><span class="p">)</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>    <span class="k">return</span> <span class="n">n</span>
</span></code></pre></div>
<p>Dans le programme on a également affiché le nombre de tentatives infructueuses avant de trouver un nombre premier. On constate que le plus souvent, moins de 500 itérations suffisent.</p>
<p>Cela est expliqué par le fameux <em>Théorème des nombres premiers</em> qui nous dit que le nombre de nombres premiers inférieur à <span class="arithmatex">\(x\)</span>, noté  <span class="arithmatex">\(\pi(x)\)</span> vérifie :</p>
<div class="arithmatex">\[
\pi(x) \sim \frac{x}{\ln(x)}
\]</div>
<p>Ainsi, la probabilité qu'un entier aléatoire soit premier est de l'ordre de <span class="arithmatex">\(\frac{1}{\ln(x)}\)</span>. Dans notre cas, on a environ <span class="arithmatex">\(x = 2^{512}\)</span> ce qui donne une probabilité de 0,28%. Les nombres premiers sont rares mais pas si rares ! Ainsi si on teste pour 500 entiers grands entiers s'ils sont premier, on en trouvera en moyenne 1,5, ce qui explique que notre procédure fonctionne en pratique.</p>
<h4 id="algorithme-du-recuit-simule">Algorithme du recuit simulé</h4>
<p>Cet algorithme sert à déterminer le maximum (ou le minimum) d'une fonction <span class="arithmatex">\(f : E \to \mathbb{R}\)</span> en s'insipirant du processus de recuit en métallurgie. Ce processus consiste à chauffer un métal puis à le laisser refroidir très lentement pour qu'il atteigne une organisation d'énergie minimale.</p>
<p>Intuitivement l'algorithme repose sur une valeur <span class="arithmatex">\(T\)</span> appelée température. Initialement on choisit un point <span class="arithmatex">\(x = x_0 \in E\)</span>. À chaque itération, on choisit aléatoirement une nouvelle valeur <span class="arithmatex">\(x'\)</span> voisine de l'ancienne <span class="arithmatex">\(x\)</span>. Il peut alors se produire de choses, soit on obtient une plus grande valeur <span class="arithmatex">\(f(x') &gt; f(x)\)</span> et on garde alors cette valeur <span class="arithmatex">\(x \gets x'\)</span>. Soit la valeur est plus petite et on décide si on la garde aléatoirement avec une probabilité <span class="arithmatex">\(p\)</span>. Cette probabilité est définie par :</p>
<div class="arithmatex">\[
p = \exp\left(- \frac{f(x) - f(x')}{T}\right)
\]</div>
<p>On comprend alors deux choses :
- Plus la température <span class="arithmatex">\(T\)</span> est faible, moins on a de chances d'accepter <span class="arithmatex">\(x'\)</span>
- Plus diminution de <span class="arithmatex">\(f(x)\)</span> est grande, moins on a de chances d'accepter <span class="arithmatex">\(x'\)</span></p>
<p>À la première itération, on choisit une grande valeur de <span class="arithmatex">\(T\)</span> puis à chaque itération on fait diminuer très légèrement <span class="arithmatex">\(T\)</span>.
On décide de s'arrêter soit à un nombre fixé d'itérations, soit lorsque la température est jugée assez basse.</p>
<p>Voici un exemple d'implémentation de cet algorithme en <code>OCaml</code></p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c">(* On veut maximiser la fonction sur [-6, 6] *)</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">let</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>    <span class="o">-</span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span> <span class="o">*.</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">4</span><span class="o">.</span><span class="mi">0</span> <span class="o">+.</span> <span class="mi">5</span><span class="o">.</span><span class="mi">0</span> <span class="o">*.</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span><span class="o">.</span><span class="mi">0</span> <span class="o">+.</span> <span class="mi">30</span><span class="o">.</span><span class="mi">0</span> <span class="o">*.</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="o">.</span><span class="mi">0</span> <span class="o">+.</span> <span class="mi">5</span><span class="o">.</span><span class="mi">0</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="o">;;</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="nn">Random</span><span class="p">.</span><span class="n">self_init</span> <span class="bp">()</span><span class="o">;;</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c">(* voisin de x dans [a, b] *)</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="k">let</span> <span class="n">voisin</span> <span class="n">x</span> <span class="n">a</span> <span class="n">b</span> <span class="o">=</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>    <span class="k">let</span> <span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">-.</span> <span class="o">(</span><span class="nn">Random</span><span class="p">.</span><span class="n">float</span> <span class="mi">2</span><span class="o">.</span><span class="mi">0</span><span class="o">)</span> <span class="k">in</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>    <span class="k">let</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+.</span> <span class="n">delta</span> <span class="k">in</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>    <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">a</span> <span class="k">then</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>        <span class="n">a</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>    <span class="k">else</span> <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">b</span> <span class="k">then</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>        <span class="n">b</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>    <span class="k">else</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>        <span class="n">y</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="o">;;</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="k">let</span> <span class="n">recuit</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b</span> <span class="n">x0</span> <span class="n">t0</span> <span class="n">tfinal</span> <span class="o">=</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>    <span class="k">let</span> <span class="n">t</span> <span class="o">=</span> <span class="n">ref</span> <span class="n">t0</span> <span class="k">in</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>    <span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="n">ref</span> <span class="n">x0</span> <span class="k">in</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>    <span class="k">while</span> <span class="o">(!</span><span class="n">t</span> <span class="o">&gt;</span> <span class="n">tfinal</span><span class="o">)</span> <span class="k">do</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>        <span class="k">let</span> <span class="n">y</span> <span class="o">=</span> <span class="n">voisin</span> <span class="o">!</span><span class="n">x</span> <span class="n">a</span> <span class="n">b</span> <span class="k">in</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>        <span class="k">if</span> <span class="n">f</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">f</span> <span class="o">!</span><span class="n">x</span> <span class="k">then</span> <span class="k">begin</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>            <span class="n">x</span> <span class="o">:=</span> <span class="n">y</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>        <span class="k">end</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a>        <span class="k">else</span> <span class="k">begin</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a>            <span class="k">let</span> <span class="n">p</span> <span class="o">=</span> <span class="n">exp</span> <span class="o">(-.</span> <span class="o">(</span><span class="n">f</span> <span class="o">!</span><span class="n">x</span> <span class="o">-.</span> <span class="n">f</span> <span class="n">y</span><span class="o">)</span> <span class="o">/.</span> <span class="o">!</span><span class="n">t</span><span class="o">)</span> <span class="k">in</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a>            <span class="k">if</span> <span class="o">(</span><span class="nn">Random</span><span class="p">.</span><span class="n">float</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">p</span><span class="o">)</span> <span class="k">then</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a>                <span class="n">x</span> <span class="o">:=</span> <span class="n">y</span>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a>        <span class="k">end</span><span class="o">;</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a>        <span class="n">t</span> <span class="o">:=</span> <span class="o">!</span><span class="n">t</span> <span class="o">*.</span> <span class="mi">0</span><span class="o">.</span><span class="mi">999</span><span class="o">;</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>        <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;Temperature = %f </span><span class="se">\t</span><span class="s2"> x = %f </span><span class="se">\t</span><span class="s2"> f(x) = %f</span><span class="se">\n</span><span class="s2"> &quot;</span> <span class="o">!</span><span class="n">t</span> <span class="o">!</span><span class="n">x</span> <span class="o">(</span><span class="n">f</span> <span class="o">!</span><span class="n">x</span><span class="o">)</span>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a>    <span class="k">done</span><span class="o">;</span>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a>    <span class="o">!</span><span class="n">x</span>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a><span class="o">;;</span>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a><span class="n">recuit</span> <span class="n">f</span> <span class="o">(-</span><span class="mi">6</span><span class="o">.</span><span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="mi">6</span><span class="o">.</span><span class="mi">0</span><span class="o">)</span> <span class="mi">0</span><span class="o">.</span><span class="mi">0</span> <span class="mi">10</span><span class="o">.</span><span class="mi">0</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">;;</span>
</span></code></pre></div>
<p>On remarque que l'algorithme converge vers un maximum local. Cependant il n'atteint pas nécessairement un maximum global. On obtient pas donc pas nécessairement un résultat exact.</p>
<h2 id="2-algorithmes-dapproximation">2. Algorithmes d'approximation</h2>
<p>Dans cette partie on introduit la notion de problème d'optimisation et on montre que certains sont difficiles à résoudre en pratique, en faisant le lien avec la théorie de la décidadibilité.</p>
<h3 id="a-problemes-de-decision-et-doptimisation">A. Problèmes de décision et d'optimisation</h3>
<div class="admonition abstract">
<p class="admonition-title">Définition</p>
<p>Un <strong>problème d'optimisation</strong> :</p>
<ul>
<li>prend en entrée une instance <span class="arithmatex">\(I\)</span></li>
<li>introduit une fonction <span class="arithmatex">\(f : X \to \mathbb{R}\)</span> qui dépend de l'instance <span class="arithmatex">\(I\)</span></li>
<li>cherche à déterminer une valeur <span class="arithmatex">\(x \in X\)</span> telle que <span class="arithmatex">\(f(x)\)</span> est maximal (resp. minimal)</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Exemple : chemin de poids minimal dans un graphe</p>
<p>On a déjà abordé des problèmes d'optimisation, par exemple déterminer un chemin de poids minimal entre deux sommets dans un graphe :</p>
<ul>
<li>L'instance est le graphe <span class="arithmatex">\(G\)</span>, le sommet de départ <span class="arithmatex">\(a\)</span> et le sommet d'arrivée <span class="arithmatex">\(b\)</span></li>
<li><span class="arithmatex">\(X\)</span> est l'ensemble des chemins de <span class="arithmatex">\(a\)</span> vers <span class="arithmatex">\(b\)</span></li>
<li><span class="arithmatex">\(f : X \to \mathbb R\)</span> est la fonction qui à chaque chemin associe son poids. On cherche à minimiser <span class="arithmatex">\(f\)</span>.</li>
</ul>
<p>Pour cet exemple, on connait des algorithmes efficaces pour répondre à la question.</p>
</div>
<h4 id="lien-avec-les-problemes-de-decision">Lien avec les problèmes de décision</h4>
<p>Tout problème d'optimisation peut être transformé en problème de décision à l'aide d'un seuil. Soit <span class="arithmatex">\(A\)</span> un problème de maximisation (par exemple) on pose le problème de décision <span class="arithmatex">\(B\)</span> suivant :</p>
<p><strong>Instance</strong> : une instance de <span class="arithmatex">\(A\)</span> et une valeur <span class="arithmatex">\(v\)</span> de seuil</p>
<p><strong>Question</strong> : existe-t-il <span class="arithmatex">\(x \in X\)</span> tel que <span class="arithmatex">\(f(x) &gt; v\)</span> ?</p>
<p>À quoi sert ce problème de décision ? Et bien il est utile car le problème d'optimisation <span class="arithmatex">\(A\)</span> est plus difficile à résoudre que le problème de décision <span class="arithmatex">\(B\)</span>. En effet, si on sait résoudre le problème d'optimisation en temps polynomial, c'est-à-dire on est capable de calculer la valeur <span class="arithmatex">\(M\)</span> maximale de <span class="arithmatex">\(f\)</span> alors on peut répondre immédiatement à la question <span class="arithmatex">\(\exists x : f(x) &gt; v ?\)</span> pour toute valeur de seuil <span class="arithmatex">\(v\)</span> : il suffit de regarder si <span class="arithmatex">\(v \geq M\)</span>.</p>
<p>Donc si le problème de décision associé à un problème d'optimisation est difficile, cela sera aussi le cas du problème d'optimisation. Par exemple, on a la proposition suivante :</p>
<div class="admonition tip">
<p class="admonition-title">Proposition</p>
<p>Soit <span class="arithmatex">\(A\)</span> un problème d'optimisation, et <span class="arithmatex">\(B\)</span> le problème de décision associé. Si <span class="arithmatex">\(B\)</span> est NP-complet alors il n'existe pas d'algorithme permettant de résoudre <span class="arithmatex">\(A\)</span> en temps polynomial, à moins que <span class="arithmatex">\(P = NP\)</span>.</p>
</div>
<p>Considérons le problème d'optimisation suivant appelé <strong>MAX-CLIQUE</strong></p>
<p><strong>Instance :</strong> un graphe <span class="arithmatex">\(G\)</span> non orienté</p>
<p><strong>But</strong> : trouver une clique <span class="arithmatex">\(C\)</span> de <span class="arithmatex">\(G\)</span> de taille maximale</p>
<p>Le problème de décision associé est le suivant :</p>
<p><strong>Instance :</strong> un graphe <span class="arithmatex">\(G\)</span> non orienté et une valeur <span class="arithmatex">\(v\)</span></p>
<p><strong>Question :</strong> existe-t-il une clique de taille <span class="arithmatex">\(&gt; v\)</span> ?</p>
<p>Il est facile de montrer que ce problème est NP-complet, donc il n'existe pas d'algorithme polynomial pour résoudre <strong>MAX-CLIQUE</strong> à moins que <span class="arithmatex">\(P = NP\)</span>.</p>
<h3 id="b-algorithme-dapproximation">B. Algorithme d'approximation</h3>
<p>Que faire lorsqu'a montré qu'un problème d'optimisation est difficile ? Une manière de surmonter le problème est de se dire que l'on a peut-être été trop ambitieux sur la tâche à accomplir : il n'est peut-être pas nécessaire d'obtenir une solution optimale mais une bonne solution peut suffire. </p>
<div class="admonition abstract">
<p class="admonition-title">Définition : approximation d'un problème de maximisation</p>
<p>Soit <span class="arithmatex">\(A\)</span> un problème de maximisation, <span class="arithmatex">\(f\)</span> la fonction à maximiser et notons <span class="arithmatex">\(M(I) = \max_{x \in X} f(x)\)</span> le maximum que l'on peut obtenir pour <span class="arithmatex">\(f\)</span> sur une instance <span class="arithmatex">\(I\)</span>.
Soit un réel <span class="arithmatex">\(0 &lt; \rho &lt; 1\)</span>. On dit qu'un algorithme fournit une <span class="arithmatex">\(\rho\)</span>-approximation de <span class="arithmatex">\(A\)</span> si pour toute instance <span class="arithmatex">\(I\)</span> il propose une solution <span class="arithmatex">\(x \in X\)</span> telle que :</p>
<div class="arithmatex">\[\rho M(I) \leq f(x) \leq M(I) \]</div>
</div>
<h4 id="le-probleme-max-sat">Le problème <strong>MAX-SAT</strong></h4>
<p>À titre d'exemple considérons le problème <strong>MAX-SAT</strong> suivant :</p>
<p><strong>Instance</strong> : une formule propositionnelle sous forme normale conjonctive</p>
<p><strong>But</strong> : trouver une valuation qui maximise le nombre de clauses satisfaites</p>
<p>Si on utilise la conversion en problème de décision, on s'apercoit qu'il s'agirait de savoir si on peut satisfaire <span class="arithmatex">\(k\)</span> clauses d'une formule ce qui est encore plus difficile que de savoir si on peut satisfaire la formule en entier. Ce problème d'optimisation est donc difficile.</p>
<p>Pour le résoudre on propose l'algorithme probabiliste de Monte-Carlo suivant : pour chaque variable dire qu'elle est vraie avec probabilité <span class="arithmatex">\(1/2\)</span>. Si chaque clause contient au moins <span class="arithmatex">\(k\)</span> variables on obtient une <span class="arithmatex">\((1 - 2^{-k})\)</span>-approximation en moyenne. Par exemple si on considère des formules de 3-CNF-SAT, on obtient une <span class="arithmatex">\(7/8\)</span>-approximation en moyenne.</p>
<p>Pour montrer ce résultat on va montrer que cette méthode satisfait une proportion <span class="arithmatex">\((1-2^{-k})\)</span> de toutes les clauses. On considère une clause <span class="arithmatex">\((l_1 \lor l_2 \lor \dots \lor l_p)\)</span> où les littéraux concernent des variables distinctes et <span class="arithmatex">\(p \geq k\)</span>. Alors la probabilité que cette clause ne soit pas satisfaite est <span class="arithmatex">\(1/2^p \leq 1/2^k\)</span>. Donc la probabilité que la clause soit satisfaite est au moins <span class="arithmatex">\((1 - 1/2^k)\)</span>. Si <span class="arithmatex">\(d\)</span> est le nombre de clauses, le nombre de clauses satisfaites en moyennes sera :</p>
<div class="arithmatex">\[ \mathbb{E}(C) \geq (1 - 2^{-k}) d \geq (1 - 2^{-k}) M(I) \]</div>
<p>on obtient donc bien :</p>
<div class="arithmatex">\[ (1 - 2^{-k}) M(I) \leq \mathbb{E}(C) \leq M(I) \]</div>
<p>Ainsi nous voyons comme un algorithme de Monte Carlo peut obtenir un résultat approché correct en moyenne d'un problème d'optimisation difficile à résoudre de manière exacte.</p>
<p>Remarquons que ce résultat est un peu déroutant : il nous apprend qu'une valuation aléatoire aura tendance à satisfaire un grand nombre de clauses d'une formule sous forme normale conjonctive.</p>
<p>Nous donnons maintenant l'équivalent d'approximation pour un problème de minimisation :</p>
<div class="admonition abstract">
<p class="admonition-title">Définition : approximation d'un problème de minimisation</p>
<p>Soit <span class="arithmatex">\(A\)</span> un problème de minimisation, <span class="arithmatex">\(f\)</span> la fonction à minimiser et notons <span class="arithmatex">\(m(I) = \min_{x \in X} f(x)\)</span> le minimum que l'on peut obtenir pour <span class="arithmatex">\(f\)</span> sur une instance <span class="arithmatex">\(I\)</span>.
Soit un réel <span class="arithmatex">\(\rho &gt; 1\)</span>. On dit qu'un algorithme fournit une <span class="arithmatex">\(\rho\)</span>-approximation de <span class="arithmatex">\(A\)</span> si pour toute instance <span class="arithmatex">\(I\)</span> il propose une solution <span class="arithmatex">\(x \in X\)</span> telle que :</p>
<div class="arithmatex">\[M(I) \leq f(x) \leq \rho M(I)\]</div>
</div>
<div class="admonition info">
<p class="admonition-title">Remarque</p>
<p>Que ce soit pour un problème de maximisation ou de minimisation, on préfère obtenir une <span class="arithmatex">\(\rho\)</span>-approximation pour <span class="arithmatex">\(\rho\)</span> aussi proche de 1 que possible. Plus <span class="arithmatex">\(\rho\)</span> est proche de 1, meilleure est la qualité de l'approximation.</p>
</div>
<p>À titre d'exemple on peut considérer le fameux problème du voyageur de commerce <strong>TSP</strong> (travelling salesman problem)</p>
<p><strong>Instance</strong> : un ensemble de <span class="arithmatex">\(n\)</span> villes et la matrice de distances entre chaque villes
<strong>But</strong> : trouver une tournée (un cycle) qui passe une et une seule fois par chaque ville et de distance totale minimale</p>
<p>Il est possible de montrer que le problème de décision associé est NP-complet (par réduction depuis le problème de cycle hamiltonien lui-même NP-complet). C'est donc un problème d'optimisation difficile. De plus il est aussi possible de montrer qu'il n'admet pas de <span class="arithmatex">\((1+\varepsilon)\)</span>-approximation en temps polynomial et ce pour tout <span class="arithmatex">\(\varepsilon &gt; 0\)</span>. C'est donc vraiment un problème théoriquement difficile qui fait encore l'objet de recherches aujourd'hui.</p>
<p>Toutefois, il existe de nombreuses méthodes approchées pour résoudre le problème du voyageur de commerce en pratique (sur des petits exemples). On peut par exemple utiliser l'algorithme de Monte Carlo du recuit simulé pour obtenir une bonne solution.</p>
<p><a href="http://people.irisa.fr/Francois.Schwarzentruber/mit1_algo2_2013/tsp/">Recuit simulé pour le voyateur de commerce</a></p>
<p>(Remerciement aux auteurs : Guillaume Grodwohl et François Schwarzentruber)</p>
<p>Une autre méthode non probabiliste est d'utiliser un algorithme de type séparation-évaluation <strong>branch and bound</strong> (voir TP).</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "content.code.select", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>